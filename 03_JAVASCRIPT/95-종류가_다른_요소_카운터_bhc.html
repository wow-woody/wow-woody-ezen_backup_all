<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <style>
        .goods-page-wrap .inner {
            display: flex;
            /* background-color: pink; */
            max-width: 1200px;
            margin: 0 auto;
            position: relative;
        }

        .goods-page-wrap .inner>div {
            flex: 1;
        }

        .goods-list {
            border: 1px solid #ccc;
            line-height: 2;
            padding: 20px;
        }

        .goods-list>.item {
            display: flex;
            justify-content: space-between;
        }

        .total-wrap {
            position: absolute;
            background: #fff;
            width: 100%;
            top: 100%;
            display: flex;
            justify-content: space-between;
            border: 1px solid #ccc;
            padding: 20px;
        }
        
    </style>
    <script>
        window.onload = function () {

            // 공통 사항 추가 옵션
            const minusBtns = document.querySelectorAll('.goods-list .minus'); //왼쪽 버튼 - 기본 메뉴 수량 증가 버튼
            const plusBtns = document.querySelectorAll('.goods-list .plus');  // 오른쪽 버튼 - 기본 메뉴 수량 감소 버튼
            let total = document.querySelector('.total span'); // 모든 합계를 보여줄 영역 선택

            // 기본 메뉴의 가격과 수량
            const basicPrice = 18000;
            let basicCount = 1;  // 기본 메뉴는 1개 부터 시작 하는 명령어
            const basespan = document.querySelector('.basic-item-btn span');        // 기본 메뉴 수량 보여줄 영역
            const basicMinus = document.querySelector('.basic-item-btn .minus');    // 기본 메뉴 수량 감소 버튼
            const basicPlus = document.querySelector('.basic-item-btn .plus');      // 기본 메뉴 수량 증가 버튼
            const selectBasic = document.querySelector('.basic-goods-wrap h2');    // 시작하면 바로 보여줄 제품명(옵션의 종류 버튼)

            // 기본으로 선택된 제품명을 보여줄 영역
            // 영역에 기본 제품명 보여주기
            const showBasic = document.querySelector('.selected-basic');
            showBasic.innerHTML = selectBasic.innerHTML  // 변수명.innerHTML은 값을 가져오거나 넣거나 둘다 가능

            // 기본 제품 수량 보여주기
            basespan.innerHTML = basicCount;

            // 기본에 있는 PLUS 버튼을 클릭하면 개수 baseCount를 1씩 증가
            basicPlus.addEventListener('click', () => {
                basicCount++;
                basespan.innerHTML = basicCount; // 증가된 수량을 보여주기
                updateTotal(); // 가격을 계산하는 함수 호출
            });



            // 기본에 있는 minus 버튼을 클릭하면 개수 baseCount를 1씩 감소
            basicMinus.addEventListener('click', () => {
                if (basicCount > 1) { // 기본 메뉴는 최소 1개 이상
                    basicCount--;
                    basespan.innerHTML = basicCount; // 감소된 수량을 보여주기
                    updateTotal(); // 가격을 계산하는 함수 호출
                }
                // 옵션의 더하기
                plusMinus.forEach(() => {
                    btn.addEventListener('click', () => {
                        let spanCount = btn.previousElementSibling; // 버튼의 이전 요소를 선택
                        let count = parseInt(spanCount.textContent); // parsInt() : 문자를 숫자로 변환
                        count++;
                        spanCount.innerHTML = count;
                        updateTotal(); // 가격을 계산하는 함수 호출


                    });
                });



                // 옵션의 마니어스
                minusBtn.forEach(btn => {
                    btn.addEventListerner('click', () => {
                        let spanCount = btn.nextElementSibling; // 버튼의 다음 요소를 선택
                        let count = parseInt(spanCount.textContent);
                        //let count = parseInt(spanCount.innerHTML); // parsInt() : 문자를 숫자로 변환
                        if (count > 0) {
                            count--;
                            spanCount.textContent = count;
                            // spanCount.innerHTML = count;
                            updateTotal();
                            // 가격을 계산하는 함수 호출
                        };
                    });
                });
            });

            // 옵션의 플러스 버튼 이벤트
            plusBtns.forEach((btn) => {
                btn.addEventListener('click', () => {
                    let spanCount = btn.previousElementSibling;    // 버튼의 이전 요소(span)를 선택
                    let count = parseInt(spanCount.textContent);   // 현재 수량을 숫자로 변환
                    count++;
                    spanCount.innerHTML = count;
                    updateTotal(); // 가격을 계산하는 함수 호출
                });
            });

            // 옵션의 마이너스 버튼 이벤트
            minusBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    let spanCount = btn.nextElementSibling;         // 버튼의 다음 요소(span)를 선택
                    let count = parseInt(spanCount.textContent);   // 현재 수량을 숫자로 변환
                    if (count > 0) {
                        count--;
                        spanCount.textContent = count;
                        // spanCount.innerHTML = count;
                        updateTotal();   // 가격을 계산하는 함수 호출
                    };
                });
            });



            // 가격을 계산할 함수 만들기
            function updateTotal() {
                let totalSum = basicPrice * basicCount;   // 기본(뿌링클) 가격과 수량을 곱해서 합계 구하기

                //옵션의 종류를 구해 줄 변수
                let categorySelect = { chicken: [], side: [], drink: [] };   // 옵션의 종류를 담을 객체 리스트 만들기

                // 옵션 선택 변수 선언
                let lists = document.querySelectorAll('.goods-list');   // .goods-list 옵션의 종류를 모두 선택
                lists.forEach(list => {
                    let category = list.classList[1];   // .goods-list 다음에 오는 클래스명을 구해옴 (chicken, side, drink)
                    console.log(category); // chicken, side, drink 이 콘솔에 찍힘 

                    // 긱 옵션에 있는 항목을 저장할 변수
                    let items = list.querySelectorAll('.item');   // .goods-list 안에 있는 .item 요소를 모두 선택
                    items.forEach(item => {
                        let goodsName = item.querySelector('.item-name span').textContent;        // 옵션의 제품명
                        let price = parseInt(item.querySelector('.item-name strong').innerHTML);  // 옵션의 가격
                        let count = parseInt(item.querySelector('.btn-wrap span').innerHTML);     // 옵션의 수량
                        if (count > 0) {
                            totalSum += price * count;  // 옵션의 가격과 수량을 곱해서 합계 구하기
                            categorySelect[category].push(goodsName);
                        }
                        console.log(categorySelect);
                        updateOptions('.goods-count-wrap .goods-selected', categorySelect.chicken);
                        updateOptions('.side-count-wrap .goods-selected', categorySelect.side);
                        updateOptions('.drink-count-wrap .goods-selected', categorySelect.drink);
                    });
                });
                total.textContent = totalSum;   // 최상단 선언 - 합계를 보여줄 total 가격 합계 보여주기
                console.log(total);    // total에 합계가 잘 찍히는지 콘솔에 확인
            }

            //옵션에서 선택한 종류를 보여줄 함수
            function updateOptions(selector, cateItems) {
                console.log(selector, cateItems);

                // 옵션을 보여줄 영역을 선택
                let selectorShow = document.querySelector(selector);

                // 그 옵션 안의 해당하는 cateItems 보여주기
                if (cateItems.length > 0) {
                    // 그 외 구하기
                    let extra = cateItems.length - 1;
                    selectorShow.innerHTML = `${cateItems[0]} ${extra > 0 ? `외 ${extra} 개` : ""}`
                }
            };
            updateTotal();    // 맨 처음 기본 가격을 보이도록 함수 호출
        }

    </script>
</head>

<body>
    <section class="goods-page-wrap">
        <div class="inner">
            <div class="basic-goods-wrap">
                <div class="basic">
                    <h2>뿌링클</h2>
                </div>

                <div class="basic-item-btn">
                    <button class="minus">-</button>
                    <span>0</span>
                    <button class="plus">+</button>
                </div>
            </div>

            <div class="add-goods-wrap">
                <div>
                    <h2>반마리 치킨</h2>
                    <div class="goods-list chicken">
                        <div class="item">
                            <div class="item-name">
                                <span>후라이드</span>
                                <strong>15000</strong>
                            </div>
                            <div class="btn-wrap">
                                <button class="minus">-</button>
                                <span>0</span>
                                <button class="plus">+</button>
                            </div>
                        </div>
                        <div class="item">
                            <div class="item-name">
                                <span>양념</span>
                                <strong>16000</strong>
                            </div>
                            <div class="btn-wrap">
                                <button class="minus">-</button>
                                <span>0</span>
                                <button class="plus">+</button>
                            </div>
                        </div>
                        <div class="item">
                            <div class="item-name">
                                <span>간장</span>
                                <strong>18000</strong>
                            </div>
                            <div class="btn-wrap">
                                <button class="minus">-</button>
                                <span>0</span>
                                <button class="plus">+</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div>
                    <h2>사이드</h2>
                    <div class="goods-list side">
                        <div class="item">
                            <div class="item-name">
                                <span>치킨무</span>
                                <strong>1000</strong>
                            </div>
                            <div class="btn-wrap">
                                <button class="minus">-</button>
                                <span>0</span>
                                <button class="plus">+</button>
                            </div>
                        </div>
                        <div class="item">
                            <div class="item-name">
                                <span>나초</span>
                                <strong>3000</strong>
                            </div>
                            <div class="btn-wrap">
                                <button class="minus">-</button>
                                <span>0</span>
                                <button class="plus">+</button>
                            </div>
                        </div>
                        <div class="item">
                            <div class="item-name">
                                <span>맛초킹라이스</span>
                                <strong>4000</strong>
                            </div>
                            <div class="btn-wrap">
                                <button class="minus">-</button>
                                <span>0</span>
                                <button class="plus">+</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div>
                    <h2>음료&amp;소스</h2>
                    <div class="goods-list drink">
                        <div class="item">
                            <div class="item-name">
                                <span>양념소스</span>
                                <strong>500</strong>
                            </div>
                            <div class="btn-wrap">
                                <button class="minus">-</button>
                                <span>0</span>
                                <button class="plus">+</button>
                            </div>
                        </div>
                        <div class="item">
                            <div class="item-name">
                                <span>콜라 1.25L</span>
                                <strong>2500</strong>
                            </div>
                            <div class="btn-wrap">
                                <button class="minus">-</button>
                                <span>0</span>
                                <button class="plus">+</button>
                            </div>
                        </div>
                        <div class="item">
                            <div class="item-name">
                                <span>사이다 1.25L</span>
                                <strong>2500</strong>
                            </div>
                            <div class="btn-wrap">
                                <button class="minus">-</button>
                                <span>0</span>
                                <button class="plus">+</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="total-wrap">
                <div class="selected-basic"></div>
                <div class="goods-count-wrap">
                    <span>반마리</span>
                    <strong class="goods-selected"></strong>
                </div>
                <div class="side-count-wrap">
                    <span>사이드</span>
                    <strong class="goods-selected"></strong>
                </div>
                <div class="drink-count-wrap">
                    <span>음료</span>
                    <strong class="goods-selected"></strong>
                </div>
                <div class="total">
                    <p>총 <span>0</span>원</p>
                    <p>결제하기</p>
                </div>

            </div>
        </div>
    </section>
</body>

</html>